---
title: TRACK NexusAccount (online account provider): cloud storage + backup upload + grants (local login stays local)
status: Draft
owner: @runtime @security @platform
created: 2026-01-19
links:
  - Vision: docs/agents/VISION.md
  - Playbook: docs/agents/PLAYBOOK.md
  - NexusNet SDK (accounts/OAuth/grants): tasks/TRACK-NEXUSNET-SDK.md
  - PIM Suite (Calendar + Contacts): tasks/TRACK-PIM-SUITE.md
  - Mail app (account-backed networking): tasks/TRACK-MAIL-APP.md
  - App Store (licensing/purchases; ecosystem): tasks/TRACK-APP-STORE.md
  - Accounts/Identity v1.2 (local users + sessiond): tasks/TASK-0223-accounts-identity-v1_2a-host-multiuser-sessiond.md
  - Accounts/Identity v1.2 (OS wiring + secure home): tasks/TASK-0224-accounts-identity-v1_2b-os-securefs-home-greeter-keystore.md
  - Backup/Restore v1 (NBK + backupd; offline): tasks/TASK-0161-backup-restore-v1a-host-nbk-format-pack-verify-restore.md
  - Backup/Restore v1 (OS/QEMU; offline): tasks/TASK-0162-backup-restore-v1b-os-backupd-settings-cli-selftests-docs.md
  - Store v2.2 (licensing ledger + parental/payments core): tasks/TASK-0221-store-v2_2a-host-licensed-ledger-parental-payments.md
  - TRACK NexusVideo (PeerTube client + creator economy): tasks/TRACK-NEXUSVIDEO.md
---

## Goal (track-level)

Deliver **NexusAccount** as an optional, privacy-respecting online account provider that enables:

- cloud storage (user-visible “drive” semantics) and cross-device sync,
- backup upload/restore (built on NBK as a portable backup artifact),
- and a clean per-app grant model for accessing online identity/scopes,

without violating Open Nexus OS invariants:

- **local login stays local** (identityd/sessiond remains the OS authority),
- **no ambient authority** (all online access is policy/capability-gated),
- **no global token visibility** (apps never see refresh tokens; ideally never see raw access tokens),
- **deterministic proofs** for core logic (host-first, bounded).

## Scope boundaries (anti-drift)

- This track is about **account + grants + cloud storage/sync surfaces**, not about building a monolithic “cloud OS”.
- Do not replace the local identity/session model with network auth.
- Do not introduce new crypto schemes casually; reuse keystore and existing security primitives.

## Product stance

We want “US-app easy” onboarding without forcing centralization:

- Default: offer “Create NexusAccount” in OOBE/Accounts UI as a convenience.
- Advanced: allow adding other account providers (future) via the NexusNet provider model.
- Always: users can use the OS fully without NexusAccount (offline-first).

## Architecture stance (OS-aligned)

### Authorities

- **Local identity**: `identityd` + `sessiond` (user/session lifecycle)
- **Secrets**: `keystored` (tokens, device-bound secrets)
- **Policy**: `policyd` (allow/deny, prompts, audit)
- **Network surfaces**: NexusNet (`svc.net.http.request`, OAuth2, sync) as capability-gated escapes

### Account provider model (required)

Follow the `TRACK-NEXUSNET-SDK` model:

- Accounts are added/managed in a system Accounts UI (`account.manage`).
- Apps request access via per-app grants (`account.use`) with explicit scopes.
- Tokens must never be logged; storage is mediated by keystore.

## Cloud storage + backup upload stance

We intentionally treat **NBK** as the portable backup artifact:

- `backupd` remains offline-first (v1 explicitly excludes cloud).
- Cloud upload is a separate layer that uploads NBK bundles and/or sync datasets.

This gives a clean EU-facing story: portability, interoperability, and user-controlled export.

## Phase map

### Phase 0 — Contracts + security model (host-first)

- Account provider contract (scopes, grants, audit hooks).
- Bounded OAuth2 flow model (redirect allowlists, timeouts, max payload sizes).
- A minimal “cloud storage object API” shape (upload/download/list with strict budgets).

### Phase 1 — Backup upload MVP (opt-in)

- Upload NBK bundles generated by `backupd` (or host tool) to NexusAccount storage.
- Restore flow that downloads NBK then uses existing verify/restore pipeline.
- Clear UX: “Cloud backup is optional; export is always possible”.

### Phase 2 — Drive + sync datasets

- User-visible cloud storage UI (files/folders semantics) with quotas.
- Optional sync engine for selected datasets (prefs, app data that opts in).

### Phase 3 — Account reuse + monetization hooks (shared platform)

- Reuse NexusAccount identity for paid services (enterprise channels, creator memberships),
  but keep grants per-app and auditable.

## Candidate subtasks (to be extracted into real TASK-XXXX)

- **CAND-NEXUSACCOUNT-000: Account provider contract v0 (scopes + grants + audit)**
- **CAND-NEXUSACCOUNT-010: OAuth2 hardening v0 (redirect allowlists, bounds, deterministic tests)**
- **CAND-NEXUSACCOUNT-020: Cloud storage API v0 (list/get/put; quotas; bounded retries)**
- **CAND-NEXUSACCOUNT-030: Backup upload MVP (NBK upload/download; restore pipeline integration)**
- **CAND-NEXUSACCOUNT-040: Drive UI v0 (files view, quotas, clear “local-first” messaging)**

## Security checklist (account/cloud)

- [ ] No secrets in logs/errors (tokens, auth codes, headers)
- [ ] Strict redirect allowlists + phishing-resistant UI indicators
- [ ] Bounded network reads and JSON parsing limits
- [ ] Per-app grants only; revocable; auditable
- [ ] No “cloud required” gating for core OS usability

## DON'T DO (Hard Failures)

- DON'T make NexusAccount a hard requirement for NexusSocial/Fediverse usage.
- DON'T expose refresh tokens to apps.
- DON'T add “cloud backup” claims to `backupd` v1 paths (that track explicitly excludes it).
- DON'T implement policy locally in apps (policyd is the authority).
